# History-Dependent-Physiological-Adaptation-2021
Code and data necessary for producing all figures except for some drawings from [Koganezawa, Umetani, Sato and Wakamoto - bioRxiv 2021](https://www.biorxiv.org/content/10.1101/2021.09.05.459045v1)

### Requirements
Code in the repository depends on the Python3.7.4 and following libraries. Using other versions of Python or libraries may work, but we have not checked yet.
- numpy1.18.5
- scipy1.4.1
- pandas1.0.4
- matplotlib3.2.1
- seaborn0.10.1
- fastdtw0.3.4
- jupyterlab1.0.4

### Code for generating figures
- [Single_cell_generation.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/Single_cell_generation.ipynb) generates **Figure 1D and E, 2H and I, S4, S5 and S10** relating to generation data.

- [Single_cell_figure.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/Single_cell_figure.ipynb) produces **Figure 2C-G and 4B-E**.

- [Fraction_calculation.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/Fraction_calculation.ipynb) generates **Figure 3B, C and F**

- [mCherry_CAT_histogram_before_BL.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/mCherry_CAT_histogram_before_BL.ipynb) generates **Figure 3D and E**.

- [Fluorescence_ratio_histogram_elongation_rate_scatter.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/Fluorescence_ratio_histogram_elongation_rate_scatter.ipynb) produces **Figure 4F and 5**.

- [Deletion_in_batch_culture.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/Deletion_in_batch_culture.ipynb) corresponds to **Figure S2B**.

- [MIC.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/MIC.ipynb) generates **Figure S3 and S8**.

- [mCherry_CAT_fluorescence_in_acquired_sample.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/mCherry_CAT_fluorescence_in_acquired_sample.ipynb) produces **Figure S6B**.

- [Phenotypes_before_BL.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/Phenotypes_before_BL.ipynb) corresponds to **Figure S7 and S11**.

- [Hierarchical_Clustering.ipynb](https://github.com/YKogane/History-Dependent-Physiological-Adaptation-2021/blob/main/Hierarchical_Clustering.ipynb) generates **Figure S8**.

Some codes also calculate p-value,  spearman &rho; and 95\% confidence interval.

### Data and code for generating data.
- common_function contains two .py files. mic.py include functions used in MIC.ipynb. single-cell.py contains functions for integrating raw single-cell transition data and  calculating elongation rates and fluorescence ratio per time or generations.

- singel-cell_data folder contains the raw data of single-cell analysis in ph, TxRed and YFP folders. The .csv files inside these folders contain area, slice and mean and background fluorescence data. These files were produced by segmentation and analysis of time-lapse micoscopic images using imageJ Fiji. integrated folder is generated by Data_integrator.ipynb.

- MIC_data folder contains the measured value of OD<sub>600</sub> after 23-h caltivation in each experiment.

- generation_time folder includes generation time of cell lineages in no chloramphenicol (Cp) conditions divided into resistance-gene-deleted cell lineages and non-deleted cell lineages. The files contain the generation time and age data.

- deletion_fraction_data folder contain Total folder and two files. Files inside the Total folder contain mean fluorescence intensities of mCherry-CAT at the time of Cp exposure, the time of Cp exposure, and the number of divisions between the timings of BL illumination and Cp exposure. "Dividing" denotes the cell fate (1 represents resistance-gene-deleted growth-restored cell lineages and 2 represents resistance-gene-deleted growth-halted cell lineages).  
Figure3_F_data.csv is the file produced by Fraction_calculation.ipynb. This file contains the probability of growth-restored cell lineages, standard error, number of lineages and mean of mCherry-CAT fluorescence intensities in top 50\% group and bottom 50\% group.  
number_of_each_type_of_cells.csv contains the number of cell lineages, resistance-gene-deleted cell lineages, flushed cell lineages and growth-restored cell lineages.

- deletion_in_batch_culture_data folder contains the raw data of the number of fluorescent (FL+) and non-fluorescent (FL-) colonies.

- FL_check.csv in acquired_sapmle_data folder contains mean and standard deviation of mCherry-CAT fluorescence intensities from microscopic images.  MIC_samples.xlsx file is the raw data of MIC test with acquired sample relate to Figure 3C.

- BL_time_Cp_time_data.csv contain the finished time of blue light illumination and the starting time of Cp exposure. This file is used in several .ipynb files.

- Data_integrator.ipynb generate integrated data from single-cell analysis data and stored at integrated folder in single-cell_data.
